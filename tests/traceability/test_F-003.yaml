# Traceability Audit: F-003
# Function: FlagLowConfidenceDetections
# Bounded Context: BC-002 (Entity Detection)

traceability_audit:
  function_id: "F-003"
  function_name: "FlagLowConfidenceDetections"
  bounded_context: "BC-002"

  implementation:
    status: "implemented"
    primary_file: "src/contextsafe/domain/entity_detection/entities/detection_result.py"
    supporting_files:
      - "src/contextsafe/domain/shared/value_objects/confidence_score.py"

  test_coverage:
    unit_tests:
      - file: "tests/unit/domain/entity_detection/test_detection_result.py"
        tests:
          - "test_needs_review_flag_low_confidence"
          - "test_needs_review_flag_high_confidence"
        status: "not_created"
    integration_tests: []
    pbt_properties:
      - "PBT-006: Low confidence always sets needs_review flag"

  traceability_chain:
    qas_refs:
      - "QAS-001"  # PII detection recall on structured text
    risk_refs:
      - "R-001"    # NER detection fails to identify PII entities
    adr_refs: []

  verification:
    implementation_exists: true
    tests_exist: false
    all_assertions_pass: false
    coverage_percent: 0

  notes: |
    DetectionResult.needs_review property flags low-confidence detections.
    Threshold defined in ConfidenceScore value object.
    Used to trigger manual review in UI.
